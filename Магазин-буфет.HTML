<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ë—É—Ñ–µ—Ç ‚Äî –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞ –î–º–∏—Ç—Ä–æ–≤</title>
<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(120deg, #0f2027, #203a43, #2c5364);
    min-height: 100vh;
}

header {
    padding: 20px;
    text-align: center;
    color: white;
}

.container {
    max-width: 900px;
    margin: 20px auto;
    background: white;
    border-radius: 20px;
    padding: 25px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

.product {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px;
    border-radius: 14px;
    background: #f5f7fa;
    margin-bottom: 12px;
    transition: transform 0.2s;
}

.product:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.product label {
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
}

.product input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

button {
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
    border: none;
    padding: 12px 18px;
    border-radius: 14px;
    font-size: 16px;
    cursor: pointer;
    transition: opacity 0.3s;
    font-weight: 600;
}

button:hover {
    opacity: 0.9;
}

button.secondary {
    background: linear-gradient(135deg, #4CAF50, #2E7D32);
}

button.danger {
    background: linear-gradient(135deg, #ff416c, #ff4b2b);
}

input, select {
    width: 100%;
    padding: 12px;
    margin-bottom: 12px;
    border-radius: 12px;
    border: 1px solid #ccc;
    font-size: 15px;
}

.section {
    margin-top: 35px;
    padding-top: 25px;
    border-top: 2px dashed #e0e0e0;
}

.seller {
    display: none;
}

.order {
    background: #eef1f7;
    padding: 14px;
    border-radius: 14px;
    margin-bottom: 12px;
    animation: fadeIn 0.5s;
}

.order.completed {
    opacity: 0.6;
    background: #f0f0f0;
}

.status-badge {
    display: inline-block;
    padding: 4px 8px;
    border-radius: 6px;
    font-size: 12px;
    font-weight: bold;
    margin-left: 10px;
}

.status-new {
    background: #ffeb3b;
    color: #333;
}

.status-done {
    background: #4CAF50;
    color: white;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* üì± –¢–ï–õ–ï–§–û–ù */
@media (max-width: 700px) {
    .container {
        margin: 10px;
        padding: 18px;
    }

    .product {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }

    button {
        width: 100%;
        font-size: 18px;
    }

    header h1 {
        font-size: 22px;
    }
}
</style>
</head>

<body>

<header>
    <h1>üçé –ë—É—Ñ–µ—Ç –ò–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π —à–∫–æ–ª—ã –≥. –î–º–∏—Ç—Ä–æ–≤–∞</h1>
    <p>–ó–∞–∫–∞–∑ –µ–¥—ã –ø–æ —à–∫–æ–ª–µ</p>
</header>

<div class="container">

<h2>üè∑Ô∏è –¢–æ–≤–∞—Ä—ã –≤ –Ω–∞–ª–∏—á–∏–∏</h2>
<div id="products">
    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
</div>

<div class="section">
    <h2>üõí –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</h2>
    <input id="buyer" placeholder="–í–∞—à–µ –∏–º—è">
    <input id="floor" placeholder="–≠—Ç–∞–∂ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3)" type="number" min="1" max="5">
    <input id="time" placeholder="–í–æ —Å–∫–æ–ª—å–∫–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 12:30)" type="time">
    <div style="margin: 15px 0; padding: 10px; background: #e8f5e9; border-radius: 10px;">
        <strong>–í—ã–±—Ä–∞–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: </strong><span id="selectedCount">0</span>
    </div>
    <button onclick="makeOrder()" class="secondary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
</div>

<div class="section">
    <button onclick="loginSeller()">üîê –í—Ö–æ–¥ –¥–ª—è –ø—Ä–æ–¥–∞–≤—Ü–∞</button>
</div>

<div class="seller" id="sellerPanel">
    <h2>üë®‚Äçüç≥ –ü–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞</h2>

    <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
    <input id="pname" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞">
    <input id="pprice" type="number" placeholder="–¶–µ–Ω–∞" min="0">
    <button onclick="addProduct()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
<h3>üìã –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h3>
    <div id="orders">
        <p>–ó–∞–∫–∞–∑—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...</p>
    </div>
    
    <button onclick="clearCompletedOrders()" class="danger" style="margin-top: 20px;">
        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
    </button>
</div>

</div>

<script>
const PASSWORD = "252525";
const MAX_ORDERS = 50; // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ö—Ä–∞–Ω–∏–º—ã—Ö –∑–∞–∫–∞–∑–æ–≤

let products = JSON.parse(localStorage.getItem("products")) || [
    { name: "–ß–∞–π", price: "30" },
    { name: "–ö–æ—Ñ–µ", price: "50" },
    { name: "–ë—É—Ç–µ—Ä–±—Ä–æ–¥", price: "70" },
    { name: "–ü–∏—Ä–æ–∂–æ–∫", price: "60" },
    { name: "–°–æ–∫", price: "45" }
];

let orders = JSON.parse(localStorage.getItem("orders")) || [];
let isSeller = false;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
function init() {
    save();
    renderProducts();
    updateSelectedCount();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —á–µ–∫–±–æ–∫—Å–æ–≤
    document.addEventListener('change', function(e) {
        if (e.target.type === 'checkbox') {
            updateSelectedCount();
        }
    });
}

function save() {
    localStorage.setItem("products", JSON.stringify(products));
    
    // –•—Ä–∞–Ω–∏–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ MAX_ORDERS –∑–∞–∫–∞–∑–æ–≤
    if (orders.length > MAX_ORDERS) {
        orders = orders.slice(orders.length - MAX_ORDERS);
    }
    localStorage.setItem("orders", JSON.stringify(orders));
}

function renderProducts() {
    const el = document.getElementById("products");
    
    if (products.length === 0) {
        el.innerHTML = "<p>–¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>";
        return;
    }

    let html = '';
    products.forEach((p, i) => {
        html += `
        <div class="product">
            <label>
                <input type="checkbox" value="${p.name}" data-price="${p.price}">
                ${p.name} ‚Äî <strong>${p.price} ‚ÇΩ</strong>
            </label>
            ${isSeller ? `<button onclick="deleteProduct(${i})" class="danger">–£–¥–∞–ª–∏—Ç—å</button>` : ``}
        </div>`;
    });
    el.innerHTML = html;
}

function updateSelectedCount() {
    const selected = document.querySelectorAll('input[type="checkbox"]:checked').length;
    document.getElementById('selectedCount').textContent = selected;
}

function addProduct() {
    const name = document.getElementById("pname").value.trim();
    const price = document.getElementById("pprice").value;

    if (!name || !price) {
        alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
        return;
    }

    if (price < 0) {
        alert("–¶–µ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π");
        return;
    }

    products.push({ name, price });
    save();
    renderProducts();
    document.getElementById("pname").value = "";
    document.getElementById("pprice").value = "";
}

function deleteProduct(i) {
    if (confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?")) {
        products.splice(i, 1);
        save();
        renderProducts();
    }
}

function makeOrder() {
    const buyer = document.getElementById("buyer").value.trim();
    const floor = document.getElementById("floor").value.trim();
    const time = document.getElementById("time").value;

    const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
    const items = Array.from(checkboxes).map(cb => cb.value);
    const totalPrice = Array.from(checkboxes).reduce((sum, cb) => sum + parseInt(cb.dataset.price || 0), 0);

    if (!buyer || !floor || !time || items.length === 0) {
        alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä");
        return;
    }

    const order = {
        id: Date.now(),
        buyer: buyer,
        floor: floor,
        time: time,
        items: items,
        total: totalPrice,
        status: 'new',
        createdAt: new Date().toLocaleString('ru-RU')
    };

    orders.push(order);
    save();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    const confirmation = `
    ‚úÖ –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!
    
    –ò–º—è: ${buyer}
    –≠—Ç–∞–∂: ${floor}
    –í—Ä–µ–º—è: ${time}
    –¢–æ–≤–∞—Ä—ã: ${items.join(', ')}
    –°—É–º–º–∞: ${totalPrice} ‚ÇΩ
    
    –°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑!`;
    
    alert(confirmation);

    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    document.getElementById("buyer").value = "";
    document.getElementById("floor").value = "";
    document.getElementById("time").value = "";
    updateSelectedCount();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –µ—Å–ª–∏ –ø—Ä–æ–¥–∞–≤–µ—Ü –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
    if (isSeller) {
        renderOrders();
    }
}

function loginSeller() {
    const password = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞:");
    if (password === PASSWORD) {
        isSeller = true;
        document.getElementById("sellerPanel").style.display = "block";
        renderProducts();
        renderOrders();
        alert("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø–∞–Ω–µ–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞!");
    } else {
        alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
    }
}

function renderOrders() {
    const el = document.getElementById("orders");
    
    if (orders.length === 0) {
        el.innerHTML = "<p>–ó–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç</p>";
        return;
    }

    // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞–∫–∞–∑—ã: –Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É
    const sortedOrders = [...orders].sort((a, b) => {
        if (a.status === b.status) return b.id - a.id;
        return a.status === 'new' ? -1 : 1;
    });

    let html = '';
    sortedOrders.forEach(order => {
        const statusText = order.status === 'new' ? '–ù–æ–≤—ã–π' : '–í—ã–ø–æ–ª–Ω–µ–Ω';
        const statusClass = order.status === 'new' ? 'status-new' : 'status-done';
        const orderClass = order.status === 'done' ? 'order completed' : 'order';
        
        html += `
        <div class="${orderClass}">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <b>${order.buyer}</b>
                    <span class="status-badge ${statusClass}">${statusText}</span>
                </div>
                <div style="font-size: 14px; color: #666;">
                    ${order.createdAt}
                </div>
            </div>
            <div style="margin-top: 8px;">
                –≠—Ç–∞–∂: ${order.floor} | –í—Ä–µ–º—è: ${order.time}<br>
                –¢–æ–≤–∞—Ä—ã: ${order.items.join(", ")}<br>
                <strong>–°—É–º–º–∞: ${order.total} ‚ÇΩ</strong>
            </div>
            ${order.status === 'new' ? 
                `<button onclick="completeOrder(${order.id})" style="margin-top: 10px; padding: 6px 12px; font-size: 14px;">
                    ‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º
                </button>` : ''
            }
        </div>`;
    });
    el.innerHTML = html;
}

function completeOrder(orderId) {
    const order = orders.find(o => o.id === orderId);
    if (order) {
        order.status = 'done';
        save();
        renderOrders();
    }
}

function clearCompletedOrders() {
    if (confirm("–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã?")) {
        orders = orders.filter(order => order.status !== 'done');
        save();
        renderOrders();
    }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
init();
</script>

</body>
</html>